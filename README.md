# LM Arena Forward

ä¸€ä¸ªåŸºäº Cloudflare Workers çš„ LM Arena ä»£ç†è½¬å‘æœåŠ¡ï¼Œç”¨äºæ™ºèƒ½è·¯ç”±å’Œè´Ÿè½½å‡è¡¡ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

LM Arena Forward æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ä»£ç†æœåŠ¡ï¼Œéƒ¨ç½²åœ¨ Cloudflare Workers ä¸Šï¼Œèƒ½å¤Ÿæ ¹æ®æ—¥æœŸè‡ªåŠ¨é€‰æ‹©ä¸åŒçš„åç«¯æœåŠ¡å™¨è¿›è¡Œè¯·æ±‚è½¬å‘ã€‚è¯¥æœåŠ¡ä¸»è¦ç”¨äº LM Arena ç›¸å…³åº”ç”¨çš„è´Ÿè½½å‡è¡¡å’Œé«˜å¯ç”¨æ€§ä¿éšœã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸš€ **é›¶å»¶è¿Ÿå¯åŠ¨** - åŸºäº Cloudflare Workers çš„æ— æœåŠ¡å™¨æ¶æ„
- ğŸŒ **å…¨çƒåˆ†å¸ƒ** - åˆ©ç”¨ Cloudflare çš„å…¨çƒè¾¹ç¼˜ç½‘ç»œ
- ğŸ“… **æ™ºèƒ½è·¯ç”±** - æ ¹æ®æ—¥æœŸè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜åç«¯æœåŠ¡å™¨
- ğŸ”„ **è‡ªåŠ¨æ•…éšœè½¬ç§»** - å†…ç½®è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»æœºåˆ¶
- ğŸ›¡ï¸ **CORS æ”¯æŒ** - å®Œæ•´çš„è·¨åŸŸèµ„æºå…±äº«æ”¯æŒ
- ğŸ“Š **å¯è§‚æµ‹æ€§** - å†…ç½®ç›‘æ§å’Œæ—¥å¿—è®°å½•

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
å®¢æˆ·ç«¯è¯·æ±‚ â†’ Cloudflare Workers â†’ åç«¯æœåŠ¡å™¨
                    â†“
              æ™ºèƒ½è·¯ç”±é€‰æ‹©
              (åŸºäºæ—¥æœŸè§„åˆ™)
```

### è·¯ç”±è§„åˆ™

æœåŠ¡æ ¹æ®å½“å‰æ—¥æœŸï¼ˆæœˆä»½ä¸­çš„å¤©æ•°ï¼‰é€‰æ‹©å¯¹åº”çš„åç«¯æœåŠ¡å™¨ï¼š

- **19æ—¥åŠä»¥å**: `https://pdsjifsoyqoy.us-west-1.clawcloudrun.com`
- **1-18æ—¥**: `https://hzaxwwzmncif.ap-northeast-1.clawcloudrun.com`

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+ 
- npm æˆ– yarn
- Cloudflare è´¦æˆ·

### å®‰è£…ä¾èµ–

```bash
npm install
```

### æœ¬åœ°å¼€å‘

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æˆ–è€…ä½¿ç”¨
npm start
```

å¼€å‘æœåŠ¡å™¨å°†åœ¨ `http://localhost:8787` å¯åŠ¨ã€‚

### è¿è¡Œæµ‹è¯•

```bash
npm test
```

### éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

```bash
npm run deploy
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
lmarena-forward/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ index.js          # ä¸»è¦çš„ Worker ä»£ç 
â”œâ”€â”€ test/
â”‚   â””â”€â”€ index.spec.js     # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ package.json          # é¡¹ç›®é…ç½®
â”œâ”€â”€ wrangler.jsonc        # Cloudflare Workers é…ç½®
â”œâ”€â”€ vitest.config.js      # æµ‹è¯•é…ç½®
â””â”€â”€ README.md            # é¡¹ç›®æ–‡æ¡£
```

## âš™ï¸ é…ç½®è¯´æ˜

### URL é…ç½®

åœ¨ `src/index.js` ä¸­çš„ `URL_CONFIG` æ•°ç»„å®šä¹‰äº†è·¯ç”±è§„åˆ™ï¼š

```javascript
const URL_CONFIG = [
  {
    start: 19,  // ä»19æ—¥å¼€å§‹
    url: "https://pdsjifsoyqoy.us-west-1.clawcloudrun.com"
  },
  {
    start: 1,   // ä»1æ—¥å¼€å§‹
    url: "https://hzaxwwzmncif.ap-northeast-1.clawcloudrun.com"
  }
];
```

### Wrangler é…ç½®

`wrangler.jsonc` æ–‡ä»¶åŒ…å«äº† Cloudflare Workers çš„éƒ¨ç½²é…ç½®ï¼š

- **name**: Worker åç§°
- **main**: å…¥å£æ–‡ä»¶è·¯å¾„
- **compatibility_date**: å…¼å®¹æ€§æ—¥æœŸ
- **routes**: è‡ªå®šä¹‰åŸŸåè·¯ç”±
- **observability**: ç›‘æ§é…ç½®

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„åç«¯æœåŠ¡å™¨

1. åœ¨ `URL_CONFIG` æ•°ç»„ä¸­æ·»åŠ æ–°çš„é…ç½®é¡¹
2. ç¡®ä¿ `start` å€¼æŒ‰é™åºæ’åˆ—
3. æµ‹è¯•è·¯ç”±é€»è¾‘

### ä¿®æ”¹è·¯ç”±è§„åˆ™

è·¯ç”±é€‰æ‹©é€»è¾‘åœ¨ `getTargetUrl()` å‡½æ•°ä¸­å®ç°ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹é€‰æ‹©ç®—æ³•ã€‚

### CORS é…ç½®

å¦‚æœéœ€è¦å¯ç”¨ CORS æ”¯æŒï¼Œå¯ä»¥å–æ¶ˆæ³¨é‡Š `forwardRequest()` å‡½æ•°ä¸­çš„ç›¸å…³ä»£ç ã€‚

## ğŸ§ª æµ‹è¯•

é¡¹ç›®ä½¿ç”¨ Vitest è¿›è¡Œæµ‹è¯•ï¼Œé…åˆ `@cloudflare/vitest-pool-workers` åœ¨ Workers ç¯å¢ƒä¸­è¿è¡Œæµ‹è¯•ã€‚

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼
npm test -- --watch
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

- å¯ç”¨äº† Cloudflare Workers çš„å¯è§‚æµ‹æ€§åŠŸèƒ½
- é”™è¯¯ä¼šè¿”å›ç»“æ„åŒ–çš„ JSON å“åº”
- åŒ…å«æ—¶é—´æˆ³çš„é”™è¯¯æ—¥å¿—

## ğŸš€ éƒ¨ç½²

### è‡ªå®šä¹‰åŸŸå

é¡¹ç›®é…ç½®äº†è‡ªå®šä¹‰åŸŸå `lmarena-forward.godgodgame.com`ï¼Œç¡®ä¿ï¼š

1. åŸŸåå·²æ·»åŠ åˆ° Cloudflare
2. DNS è®°å½•æ­£ç¡®é…ç½®
3. SSL/TLS è®¾ç½®æ­£ç¡®

### ç¯å¢ƒå˜é‡

å¦‚éœ€æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œåœ¨ `wrangler.jsonc` ä¸­é…ç½®ï¼š

```json
"vars": {
  "MY_VARIABLE": "production_value"
}
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä¸ºç§æœ‰é¡¹ç›®ï¼Œè¯·éµå®ˆç›¸å…³ä½¿ç”¨æ¡æ¬¾ã€‚

## ğŸ”— ç›¸å…³é“¾æ¥

- [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [Wrangler CLI æ–‡æ¡£](https://developers.cloudflare.com/workers/wrangler/)
- [Vitest æµ‹è¯•æ¡†æ¶](https://vitest.dev/)

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- åˆ›å»º Issue
- å‘é€é‚®ä»¶è‡³é¡¹ç›®ç»´æŠ¤è€…
- æŸ¥çœ‹é¡¹ç›® Wiki

---

**æ³¨æ„**: æœ¬æœåŠ¡ä¾èµ–äº Cloudflare Workers å¹³å°ï¼Œè¯·ç¡®ä¿è´¦æˆ·é…é¢å……è¶³å¹¶éµå®ˆå¹³å°ä½¿ç”¨æ¡æ¬¾ã€‚
